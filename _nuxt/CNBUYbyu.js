import{r as C,aQ as y,V as S,aR as w,aS as E,X as b,d as V,a4 as z,a5 as B,f as T,h as m,w as p,i as f,u,j as _,k as g,F as D,v as F,G as I,l as A,t as N,m as R,q,z as O}from"#entry";import{_ as P}from"./CogeDm5j.js";import{u as W}from"./BpBpkyY5.js";const $=({delay:t},o)=>{let e,s=!0;const n=(...l)=>{s?(clearTimeout(e),e=setTimeout(()=>{s&&o(...l),e=void 0},t)):o(...l)};return n.isPending=()=>e!==void 0,n.cancel=()=>{s=!1},n.flush=(...l)=>o(...l),n},j=({interval:t},o)=>{let e=!0,s;const n=(...l)=>{e&&(o(...l),e=!1,s=setTimeout(()=>{e=!0,s=void 0},t))};return n.isThrottled=()=>s!==void 0,n},H=t=>j({interval:20},t),G=t=>$({delay:20},t);function M(t){const o=H(t),e=G(t);return()=>{o(),e()}}function Q(t){const o=C(null),e=(d,a=[])=>(d.forEach(c=>{const r=document.getElementById(c.id);r&&a.push({id:c.id,offsetTop:r.offsetTop}),c.children&&e(c.children,a)}),a),s=y(()=>b(t),()=>e(b(t)).reverse()),n=()=>{const d=Number.parseFloat(getComputedStyle(document.documentElement).getPropertyValue("scroll-margin-top")),a=window.scrollY+(d||64),c=s.value.find(v=>v.offsetTop<=a);o.value=c?.id||null;const r=document.querySelector("#z-aside"),h=document.querySelector(`#z-aside a[href="#${o.value}"]`);r?.scroll({top:h?.offsetTop||0})};S("scroll",M(()=>n()),{passive:!0});const{height:l}=w(document?.body);return E(l,s.trigger),{activeTocItem:o}}const X={href:"#main-content","aria-label":"返回开头"},Y={href:"#twikoo","aria-label":"评论区"},Z=["href","title"],J={key:1,class:"no-toc"},K=V({__name:"Toc",setup(t){const[o,e]=z(),s=W(),{toc:n}=B(s),{activeTocItem:l}=Q(()=>n.value?.links??[]);function d(a,c){return a.id===c?!0:a.children?.some(r=>d(r,c))??!1}return(a,c)=>{const r=q,h=R,v=P;return m(),T(v,null,{title:p(()=>[c[0]||(c[0]=_("span",{class:"title"},"文章目录",-1)),_("a",X,[f(r,{name:"ph:arrow-circle-up-bold"})]),_("a",Y,[f(r,{name:"ph:chat-circle-text-bold"})])]),default:p(()=>[f(u(o),null,{default:p(({tocItem:k})=>[_("ol",null,[(m(!0),g(D,null,F(k,(i,x)=>(m(),g("li",{key:x,class:I({"has-active":d(i,u(l)),active:i.id===u(l)})},[_("a",{href:`#${i?.id}`,title:i.text},N(i.text),9,Z),i.children?(m(),T(u(e),{key:0,"toc-item":i.children},null,8,["toc-item"])):A("",!0)],2))),128))])]),_:1}),f(h,null,{default:p(()=>[u(n)?.links.length?(m(),T(u(e),{key:0,"toc-item":u(n).links},null,8,["toc-item"])):(m(),g("p",J," 暂无目录信息 "))]),_:1})]),_:1})}}}),te=Object.assign(O(K,[["__scopeId","data-v-9ccca5b3"]]),{__name:"WidgetToc"});export{te as default};
